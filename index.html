<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crypto Hub: Platform Belajar All-in-One (Final Version)</title>

    <!-- Tailwind CSS & Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet" />
    
    <!-- Chart.js Library (FIXED) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Konfigurasi Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { inter: ['Inter', 'sans-serif'], poppins: ['Poppins', 'sans-serif'] },
                    colors: {
                        cyan: { 400: '#22d3ee', 500: '#06b6d4', 600: '#0891b2' },
                        slate: { 850: '#162033', 950: '#0f172a' },
                        purple: { 500: '#8b5cf6' }
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        shake: { '0%,100%':{transform:'translateX(0)'},'10%,30%,50%,70%,90%':{transform:'translateX(-5px)'},'20%,40%,60%,80%':{transform:'translateX(5px)'} },
                        shimmer: { '100%': { transform: 'translateX(100%)' } },
                        gradientShift: { '0%,100%':{backgroundPosition:'0% 50%'}, '50%':{backgroundPosition:'100% 50%'} }
                    },
                    animation: {
                        fadeIn: 'fadeIn 0.5s ease-in-out',
                        shake: 'shake 0.5s ease-in-out',
                        shimmer: 'shimmer 1.5s infinite',
                        gradientShift: 'gradientShift 6s ease infinite'
                    }
                }
            }
        }
    </script>

    <!-- Custom Styles -->
    <style>
        body { font-family: 'Inter', sans-serif; transition: background-color 0.3s, color 0.3s; }
        h1,h2,h3,h4 { font-family: 'Poppins', sans-serif; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; }
        .dark ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #334155; }
        .nav-link.active {
            background-image: linear-gradient(to right, var(--tw-gradient-from, #06b6d4), var(--tw-gradient-to, #0891b2));
            color: white; box-shadow: 0 4px 14px 0 rgba(0, 118, 255, 0.39);
        }
        .skeleton-loader::after {
            content: ''; position: absolute; top: 0; left: -150%; width: 150%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 1.5s infinite;
        }
        .dark .skeleton-loader::after { background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent); }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out; }
        .accordion-button svg { transition: transform 0.3s ease-in-out; }
        .accordion-button.open svg { transform: rotate(180deg); }
        body.focus-mode .sidebar, body.focus-mode #page-header { display: none; }
        body.focus-mode .main-content { margin-left: 0; padding-top: 2.5rem; }
        body.focus-mode .page-container { max-width: 100%; }
        .glass-card { background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .dark .glass-card { background: rgba(15, 23, 42, 0.5); border: 1px solid rgba(255, 255, 255, 0.1); }
        .flip-card { perspective: 1000px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card:hover .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: space-between; }
        .flip-card-back { transform: rotateY(180deg); justify-content: center; }
        @media print {
            body * { visibility: hidden; }
            .print-area, .print-area * { visibility: visible; }
            .print-area { position: absolute; left: 0; top: 0; width: 100%; }
            .no-print { display: none; }
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 dark:bg-slate-950 dark:text-slate-300">

    <canvas id="confetti-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-50"></canvas>

    <div id="password-overlay" class="fixed inset-0 bg-slate-900/50 dark:bg-slate-950/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div id="password-box" class="w-full max-w-sm bg-white dark:bg-slate-900 p-8 rounded-2xl shadow-2xl text-center">
            <div class="flex justify-center mb-6">
                <svg class="w-12 h-12 text-cyan-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.62,10.95c-1.32-1.32-3.48-1.32-4.8,0L10.3,12.47c-1.32,1.32-1.32,3.48,0,4.8c1.32,1.32,3.48,1.32,4.8,0l1.52-1.52C17.95,14.43,17.95,12.27,16.62,10.95Z" fill="currentColor"/><path d="M12.47,10.3l1.52-1.52c-1.32-1.32-1.32-3.48,0-4.8c-1.32-1.32-3.48-1.32-4.8,0L7.67,5.5c-1.32,1.32-1.32,3.48,0,4.8L12.47,10.3Z" fill="currentColor" fill-opacity="0.4"/></svg>
            </div>
            <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">Akses Terbatas</h2>
            <p class="text-slate-500 dark:text-slate-400 mb-6">Masukkan password untuk membuka Crypto Hub.</p>
            <form id="password-form">
                <input type="password" id="password-input" class="w-full p-3 text-center bg-slate-100 dark:bg-slate-800 rounded-lg border border-slate-300 dark:border-slate-700 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500" placeholder="••••••••">
                <p id="password-error" class="text-red-500 text-sm mt-2 h-5"></p>
                <button type="submit" class="w-full mt-4 px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-lg hover:opacity-90 transition-opacity focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500 dark:focus:ring-offset-slate-900">Buka</button>
            </form>
        </div>
    </div>

    <div id="app-container" class="hidden flex flex-col md:flex-row min-h-screen">
        <aside class="sidebar w-full md:w-72 bg-white dark:bg-slate-900 p-6 md:sticky md:top-0 md:h-screen md:flex md:flex-col border-r border-slate-200 dark:border-slate-800 z-20 no-print">
            <div class="flex justify-between items-center mb-8">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-cyan-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.62,10.95c-1.32-1.32-3.48-1.32-4.8,0L10.3,12.47c-1.32,1.32-1.32,3.48,0,4.8c1.32,1.32,3.48,1.32,4.8,0l1.52-1.52C17.95,14.43,17.95,12.27,16.62,10.95Z" fill="currentColor"/><path d="M12.47,10.3l1.52-1.52c-1.32-1.32-1.32-3.48,0-4.8c-1.32-1.32-3.48-1.32-4.8,0L7.67,5.5c-1.32,1.32-1.32,3.48,0,4.8L12.47,10.3Z" fill="currentColor" fill-opacity="0.4"/></svg>
                    <h1 class="text-2xl font-extrabold text-slate-900 dark:text-white">Crypto Hub</h1>
                </div>
                <button id="theme-toggle" type="button" class="text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg text-sm p-2.5">
                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 100 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                </button>
            </div>
            <nav id="navigation" class="flex-grow overflow-y-auto"><ul class="space-y-2"></ul></nav>
            <div id="user-profile" class="mt-auto pt-4 border-t border-slate-200 dark:border-slate-700"></div>
        </aside>

        <main class="main-content flex-1 p-6 md:p-10 overflow-y-auto">
            <div id="page-header" class="max-w-7xl mx-auto flex justify-between items-center mb-8 no-print">
                <h2 id="page-title" class="text-3xl md:text-4xl font-extrabold text-slate-900 dark:text-white"></h2>
                 <div class="flex items-center gap-2">
                    <button id="focus-mode-toggle" title="Mode Fokus" class="text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg p-2.5">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 1v4m0 0h-4m4 0l-5-5"></path></svg>
                    </button>
                </div>
            </div>
            <div id="page-content" class="page-container max-w-7xl mx-auto"></div>
        </main>
    </div>

    <script>
        // --- DATA & CONTENT ---
        const appData = [
            { id: 'dasbor', title: 'Dasbor Harga', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>`, isLive: true },
            { id: 'kamus', title: 'Kamus Lengkap', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v11.494m-9-8.494h18m-18 4h18M5 6.253L12 2l7 4.253M5 17.747L12 22l7-4.253"></path></svg>`, isDictionary: true },
            { id: 'analisis', title: 'Analisis & Studi Kasus', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4z"></path></svg>`, content: [] },
            { id: 'tutorial', title: 'Tutorial Praktis', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>`, content: [] },
            { id: 'portofolio', title: 'Portofolio Saya', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>`, isPortfolio: true },
            { id: 'alat', title: 'Alat Bantu', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 0v6m0-6l-6 6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`, isTool: true },
            { id: 'berita', title: 'Berita Terkini', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3h2m-4 3h2M3 10h18"></path></svg>`, isNews: true },
            { id: 'kuis', title: 'Kuis Kripto', icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`, isQuiz: true },
        ];
        
        const kamusContent = [
            { category: 'Konsep Fundamental', items: [ { term: 'Blockchain', definition: 'Buku besar digital terdesentralisasi yang mencatat semua transaksi secara permanen dan transparan dalam bentuk "rantai blok". Ini adalah teknologi dasar di balik hampir semua cryptocurrency.' }, { term: 'Decentralization (Desentralisasi)', definition: 'Prinsip inti di mana kontrol dan pengambilan keputusan tidak dipegang oleh satu entitas tunggal (seperti bank atau pemerintah), melainkan didistribusikan di antara semua pengguna jaringan.' }, { term: 'Wallet (Dompet)', definition: 'Perangkat lunak atau keras untuk menyimpan dan mengelola aset digital Anda. Terdiri dari <strong>Hot Wallet:</strong> Terhubung ke internet (misal: MetaMask, Trust Wallet). Praktis untuk transaksi harian tapi lebih rentan. Dan <strong>Cold Wallet:</strong> Offline (misal: Ledger, Trezor). Paling aman untuk menyimpan aset jangka panjang.' }, { term: 'Public Key & Private Key', definition: '<strong>Public Key</strong> adalah alamat dompet Anda yang bisa Anda bagikan kepada orang lain untuk menerima dana. Mirip dengan nomor rekening bank. <strong>Private Key</strong> adalah kata sandi rahasia yang memberikan akses penuh ke aset di dompet Anda. <strong>JANGAN PERNAH</strong> membagikan ini kepada siapa pun.' }, { term: 'Seed Phrase / Recovery Phrase', definition: 'Daftar 12-24 kata yang merupakan <em>master key</em> untuk memulihkan dompet Anda jika Anda kehilangan akses. Ini sama pentingnya dengan Kunci Pribadi.' } ] },
            { category: 'Jenis Aset Digital', items: [ { term: 'Coin (Koin)', definition: 'Aset digital asli dari blockchainnya sendiri (Contoh: BTC, ETH, SOL).' }, { term: 'Token', definition: 'Aset digital yang "menumpang" di atas blockchain yang sudah ada. Token bisa merepresentasikan banyak hal, seperti utilitas, aset, hingga hak suara.' }, { term: 'NFT (Non-Fungible Token)', definition: 'Sertifikat kepemilikan digital yang unik untuk aset tertentu (karya seni, item game, tiket acara). Tidak dapat dipertukarkan satu sama lain.' }, { term: 'Stablecoin', definition: 'Cryptocurrency yang nilainya dipatok ke aset dunia nyata yang stabil, biasanya Dolar AS (1:1), untuk mengurangi volatilitas.' }, { term: 'RWA (Real World Assets)', definition: 'Proses "menokenisasi" aset fisik atau keuangan dari dunia nyata (properti, obligasi) dan membawanya ke dalam blockchain untuk meningkatkan likuiditas.'} ] },
            { category: 'Mekanisme Teknis & Skalabilitas', items: [ { term: 'Consensus Mechanism', definition: 'Aturan yang digunakan jaringan untuk menyetujui validitas transaksi. Yang paling umum adalah <strong>Proof-of-Work (PoW)</strong> dan <strong>Proof-of-Stake (PoS)</strong>.' }, { term: 'Mining (Menambang)', definition: 'Proses menggunakan kekuatan komputasi untuk memvalidasi transaksi pada jaringan PoW dan mendapatkan imbalan berupa koin baru.' }, { term: 'Staking', definition: 'Mengunci sejumlah aset crypto untuk berpartisipasi dalam mengamankan jaringan PoS dan mendapatkan imbalan.' }, { term: 'Halving', definition: 'Peristiwa terjadwal (setiap ~4 tahun untuk Bitcoin) yang memotong imbalan bagi penambang menjadi setengahnya, sehingga mengurangi laju pembuatan koin baru.' }, { term: 'Smart Contract', definition: 'Program komputer atau protokol transaksi yang secara otomatis mengeksekusi perjanjian. Ini adalah tulang punggung dari DeFi dan DAO.' }, { term: 'Layer 1 (L1) & Layer 2 (L2)', definition: '<strong>L1</strong> adalah blockchain dasarnya (misal: Ethereum). <strong>L2</strong> adalah solusi yang dibangun di atas L1 untuk membuat transaksi lebih cepat dan murah (misal: Arbitrum, Polygon).' } ] },
            { category: 'Ekosistem & Aplikasi', items: [ { term: 'DeFi (Decentralized Finance)', definition: 'Ekosistem layanan keuangan tanpa perantara tradisional seperti bank (pinjam-meminjam, bursa).' }, { term: 'DEX (Decentralized Exchange)', definition: 'Bursa terdesentralisasi tempat pengguna dapat menukar aset crypto secara langsung satu sama lain (peer-to-peer), contoh: Uniswap.' }, { term: 'DAO (Decentralized Autonomous Organization)', definition: 'Organisasi yang dijalankan oleh kode dan dikelola oleh komunitas melalui pemungutan suara (voting).' }, { term: 'GameFi & Metaverse', definition: '<strong>GameFi</strong> menggabungkan game dengan elemen keuangan (Play-to-Earn). <strong>Metaverse</strong> adalah dunia virtual persisten tempat pengguna berinteraksi dan bertransaksi.'} ] },
            { category: 'Tokoh & Peristiwa Penting', items: [ { term: 'Satoshi Nakamoto', definition: 'Nama samaran dari orang atau kelompok yang menciptakan Bitcoin. Identitas aslinya tetap menjadi misteri terbesar di dunia teknologi hingga hari ini.' }, { term: 'Vitalik Buterin', definition: 'Programmer Rusia-Kanada yang merupakan salah satu pendiri Ethereum, mengusulkan blockchain yang bisa menjalankan smart contract.' }, { term: 'The DAO Hack (2016)', definition: 'Peretasan besar di jaringan Ethereum yang memicu perdebatan sengit dan akhirnya menyebabkan <em>hard fork</em> yang memecah Ethereum menjadi dua: Ethereum (ETH) dan Ethereum Classic (ETC).' } ] },
            { category: 'Istilah Pasar & Budaya (Slang)', items: [ { term: 'HODL', definition: 'Berasal dari salah ketik "hold". Istilah slang untuk menahan investasi crypto dalam jangka panjang, tidak peduli fluktuasi pasar.' }, { term: 'FOMO & FUD', definition: '<strong>FOMO (Fear of Missing Out):</strong> Rasa takut ketinggalan yang mendorong pembelian impulsif di harga tinggi. <strong>FUD (Fear, Uncertainty, Doubt):</strong> Menyebar berita negatif untuk menurunkan harga.' }, { term: 'Whale (Paus)', definition: 'Individu atau entitas yang memiliki jumlah aset crypto yang sangat besar dan bisa mempengaruhi pasar.' }, { term: 'ATH & ATL', definition: '<strong>ATH (All-Time High):</strong> Harga tertinggi yang pernah dicapai oleh sebuah aset. <strong>ATL (All-Time Low):</strong> Harga terendah yang pernah dicapai.' }, { term: 'DYOR (Do Your Own Research)', definition: '"Lakukan riset Anda sendiri." Nasihat paling penting di dunia crypto sebelum berinvestasi.' } ] }
        ];
        
        const analisisContent = [
             { term: 'Analisis Fundamental vs Teknikal', definition: `Dua pendekatan utama dalam menganalisis aset. <strong>Fundamental (FA)</strong> melihat nilai intrinsik proyek (tim, teknologi, tokenomics) untuk jangka panjang. <strong>Teknikal (TA)</strong> menganalisis pola harga dan volume di chart untuk prediksi jangka pendek.` },
             { term: 'Membaca Candlestick Chart', definition: `Setiap 'lilin' menunjukkan harga pembukaan, penutupan, tertinggi, dan terendah. Warna hijau berarti harga naik pada periode itu, merah berarti turun. Badan lilin menunjukkan rentang antara harga buka dan tutup, sedangkan 'sumbu' menunjukkan harga ekstrem.<br><div class="mt-4 p-4 bg-slate-100 dark:bg-slate-800 rounded-lg">${createCandlestickSVG()}</div>` },
             { term: 'Support & Resistance', definition: `Level harga psikologis. <strong>Support</strong> adalah 'lantai' di mana harga cenderung berhenti turun. <strong>Resistance</strong> adalah 'atap' di mana harga cenderung berhenti naik. Penembusan level ini seringkali menandakan kelanjutan tren.<br><div class="mt-4 p-4 bg-slate-100 dark:bg-slate-800 rounded-lg">${createSupportResistanceSVG()}</div>` },
             { term: 'Studi Kasus: Membedah Transaksi di Etherscan', definition: `Etherscan adalah 'Google' untuk blockchain Ethereum. Anda bisa melacak transaksi apa pun. Komponen utamanya adalah: <strong>Txn Hash (ID unik)</strong>, <strong>From (pengirim)</strong>, <strong>To (penerima)</strong>, <strong>Value (jumlah)</strong>, dan <strong>Gas Fee (biaya transaksi)</strong>.<br><div class="mt-4 p-4 bg-slate-100 dark:bg-slate-800 rounded-lg">${createEtherscanSVG()}</div>` },
        ];
        appData.find(p => p.id === 'analisis').content = analisisContent;
        
        const tutorialContent = [
            { term: 'Cara Membuat Wallet MetaMask', definition: `<ol class="list-decimal list-inside mt-2 space-y-2"><li><strong>Unduh Ekstensi:</strong> Kunjungi situs resmi (metamask.io) dan pasang ekstensi untuk browser Anda.</li><li><strong>Buat Dompet Baru:</strong> Ikuti instruksi dan buat kata sandi yang kuat.</li><li><strong>AMANKAN SEED PHRASE:</strong> Bagian terpenting. Tulis 12 kata rahasia di kertas dan simpan di tempat sangat aman. Jangan pernah membagikannya atau menyimpannya secara digital.</li><li><strong>Konfirmasi & Selesai:</strong> Konfirmasi seed phrase Anda, dan dompet siap digunakan.</li></ol>` },
            { term: 'Tips Keamanan Paling Penting', definition: `<ul class="list-disc list-inside mt-2 space-y-2"><li><strong>Jangan Percaya DM/Email:</strong> Tim resmi tidak akan pernah meminta seed phrase atau uang Anda.</li><li><strong>Gunakan Hardware Wallet:</strong> Untuk dana besar, Cold Wallet adalah yang teraman.</li><li><strong>Verifikasi Alamat & Situs:</strong> Selalu periksa ulang alamat tujuan dan gunakan bookmark untuk situs penting untuk menghindari phishing.</li></ul>` },
        ];
        appData.find(p => p.id === 'tutorial').content = tutorialContent;

        const fullQuizBank = [
            { q: "Apa nama samaran dari pencipta Bitcoin?", o: ["Vitalik Buterin", "Satoshi Nakamoto", "Elon Musk", "CZ"], a: "Satoshi Nakamoto" }, { q: "Aset digital yang berjalan di atas blockchain lain disebut...", o: ["Coin", "Fiat", "Token", "Saham"], a: "Token" }, { q: "Di mekanisme konsensus apa para 'penambang' berkompetisi?", o: ["Proof-of-Stake", "Proof-of-History", "Proof-of-Work", "DPoS"], a: "Proof-of-Work" }, { q: "Istilah untuk menahan aset crypto jangka panjang adalah...", o: ["FUD", "FOMO", "Shill", "HODL"], a: "HODL" }, { q: "Apa fungsi utama dari Stablecoin?", o: ["Investasi spekulatif", "Menjaga stabilitas nilai", "Mendapat bunga tinggi", "Untuk game"], a: "Menjaga stabilitas nilai" }, { q: "NFT adalah singkatan dari...", o: ["New Financial Token", "Non-Fungible Token", "National Fiat Token", "Network Fee Token"], a: "Non-Fungible Token" }, { q: "Layanan keuangan tanpa perantara di blockchain disebut...", o: ["CeFi", "TradFi", "DeFi", "FinTech"], a: "DeFi" }, { q: "Level harga di mana tren turun cenderung berhenti disebut...", o: ["Resistance", "Breakout", "Support", "Trendline"], a: "Support" }, { q: "Apa itu 'Gas Fee' di jaringan Ethereum?", o: ["Biaya internet", "Biaya transaksi", "Pajak pemerintah", "Biaya listrik"], a: "Biaya transaksi" }, { q: "Apa nama bursa crypto yang diretas pada tahun 2014?", o: ["Binance", "Coinbase", "Mt. Gox", "Kraken"], a: "Mt. Gox" },
        ];
        
        // --- ALL JAVASCRIPT FUNCTIONS ---
        
        function createCandlestickSVG() { return `<svg viewBox="0 0 300 150" class="w-full h-auto"><defs><style>.label{font-size:10px; fill:currentColor; font-family: Inter, sans-serif;}</style></defs><g transform="translate(50 20)"><rect x="0" y="40" width="40" height="50" fill="#22c55e"/><line x1="20" y1="0" x2="20" y2="40" stroke="#22c55e" stroke-width="2"/><line x1="20" y1="90" x2="20" y2="110" stroke="#22c55e" stroke-width="2"/><text x="65" y="10" class="label font-bold">High</text><line x1="42" y1="5" x2="60" y2="5" stroke="currentColor" stroke-dasharray="2 2"/><text x="65" y="45" class="label">Open</text><line x1="42" y1="40" x2="60" y2="40" stroke="currentColor" stroke-dasharray="2 2"/><text x="65" y="95" class="label">Close</text><line x1="42" y1="90" x2="60" y2="90" stroke="currentColor" stroke-dasharray="2 2"/><text x="65" y="115" class="label font-bold">Low</text><line x1="42" y1="110" x2="60" y2="110" stroke="currentColor" stroke-dasharray="2 2"/></g><g transform="translate(180 20)"><rect x="0" y="25" width="40" height="50" fill="#ef4444"/><line x1="20" y1="0" x2="20" y2="25" stroke="#ef4444" stroke-width="2"/><line x1="20" y1="75" x2="20" y2="110" stroke="#ef4444" stroke-width="2"/></g></svg>`; }
        function createSupportResistanceSVG() { return `<svg viewBox="0 0 300 150" class="w-full h-auto"><defs><style>.label{font-size:10px; fill:currentColor; font-family: Inter, sans-serif;}</style></defs><path d="M20 120 C 60 40, 80 140, 120 90 S 180 20, 220 70 S 260 110, 280 80" stroke="#06b6d4" stroke-width="2.5" fill="none"/><line x1="10" y1="40" x2="290" y2="40" stroke="#ef4444" stroke-width="2" stroke-dasharray="4 4"/><text x="110" y="35" class="label font-bold text-red-500 fill-current">Resistance (Atap)</text><line x1="10" y1="120" x2="290" y2="120" stroke="#22c55e" stroke-width="2" stroke-dasharray="4 4"/><text x="110" y="135" class="label font-bold text-green-500 fill-current">Support (Lantai)</text></svg>`; }
        function createEtherscanSVG() { return `<svg viewBox="0 0 300 150" class="w-full h-auto"><defs><style>.label{font-size:10px; fill:currentColor; font-family: Inter, sans-serif;}.box{fill:currentColor; fill-opacity:0.1; stroke:currentColor; stroke-width:0.5;}</style></defs><rect x="10" y="55" width="80" height="40" rx="8" class="box"/><text x="25" y="78" class="label font-bold">Pengirim</text><rect x="210" y="55" width="80" height="40" rx="8" class="box"/><text x="225" y="78" class="label font-bold">Penerima</text><path d="M90 75 L 210 75" stroke="currentColor" stroke-width="2" marker-end="url(#arrow)"/><text x="120" y="70" class="label">0.1 ETH</text><text x="120" y="90" class="label text-cyan-500 fill-current">Gas Fee</text><defs><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="currentColor"/></marker></defs></svg>`; }
        
        function renderPage(pageId) {
            const pageData = appData.find(p => p.id === pageId);
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.querySelector(`.nav-link[data-page="${pageId}"]`).classList.add('active');
            
            document.getElementById('page-title').textContent = pageData.title;
            
            const pageContentEl = document.getElementById('page-content');
            pageContentEl.innerHTML = `<div id="page-dynamic-content" class="animate-fadeIn space-y-6"></div>`;
            const dynamicContentEl = document.getElementById('page-dynamic-content');

            if (pageData.isLive) renderPriceTracker(dynamicContentEl);
            else if (pageData.isDictionary) renderDictionary(dynamicContentEl);
            else if (pageData.isQuiz) renderQuiz(dynamicContentEl);
            else if (pageData.isTool) renderTools(dynamicContentEl);
            else if (pageData.isNews) renderNews(dynamicContentEl);
            else if (pageData.isPortfolio) renderPortfolio(dynamicContentEl);
            else if (pageData.content) {
                 dynamicContentEl.innerHTML = pageData.content.map(item => `
                    <div class="card-item bg-white dark:bg-slate-900 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-500 to-blue-500 mb-2">${item.term}</h3>
                            <button title="Cetak Bagian Ini" class="print-button no-print text-slate-400 hover:text-cyan-500">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg>
                            </button>
                        </div>
                        <div class="definition-content text-slate-600 dark:text-slate-300 leading-relaxed">${item.definition}</div>
                    </div>`).join('');
            }
        }
        
        function renderDictionary(container) {
            container.innerHTML = ` <div class="relative mb-6 no-print"> <input type="text" id="kamus-search" placeholder="Cari istilah di kamus..." class="w-full p-3 pl-10 bg-white dark:bg-slate-800 rounded-lg border border-slate-300 dark:border-slate-700"> <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"><svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div> </div> <div id="kamus-accordion-container" class="space-y-4"></div> <div id="kamus-search-results" class="hidden space-y-4"></div> `;
            const accordionContainer = document.getElementById('kamus-accordion-container');
            accordionContainer.innerHTML = kamusContent.map((cat) => ` <div class="bg-white dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-800 overflow-hidden"> <button class="accordion-button w-full flex justify-between items-center p-4 text-left font-bold text-slate-800 dark:text-slate-200"> <span>${cat.category}</span> <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg> </button> <div class="accordion-content px-4"> <div class="py-4 border-t border-slate-200 dark:border-slate-700 space-y-4"> ${cat.items.map(item => ` <div class="card-item"> <h4 class="text-md font-bold text-cyan-600 dark:text-cyan-400">${item.term}</h4> <p class="text-slate-600 dark:text-slate-400 text-sm">${item.definition}</p> </div> `).join('')} </div> </div> </div> `).join('');
            document.getElementById('kamus-search').addEventListener('input', handleKamusSearch);
        }
        
        function handleKamusSearch(e) { const query = e.target.value.toLowerCase(); const accordionContainer = document.getElementById('kamus-accordion-container'); const resultsContainer = document.getElementById('kamus-search-results'); if (!query) { accordionContainer.classList.remove('hidden'); resultsContainer.classList.add('hidden'); return; } const results = []; kamusContent.forEach(cat => { cat.items.forEach(item => { if (item.term.toLowerCase().includes(query) || item.definition.toLowerCase().includes(query)) { results.push(item); } }); }); accordionContainer.classList.add('hidden'); resultsContainer.classList.remove('hidden'); if (results.length > 0) { resultsContainer.innerHTML = results.map(item => ` <div class="bg-white dark:bg-slate-900 p-4 rounded-lg border border-slate-200 dark:border-slate-800"> <h4 class="text-md font-bold text-cyan-600 dark:text-cyan-400">${item.term}</h4> <p class="text-slate-600 dark:text-slate-400 text-sm">${item.definition}</p> </div>`).join(''); } else { resultsContainer.innerHTML = `<p class="text-center text-slate-500">Tidak ada istilah yang ditemukan.</p>`; } }
        
        async function fetchCryptoPrices(coinIds = ['bitcoin', 'ethereum', 'solana', 'ripple', 'tether', 'cardano']) {
            try {
                const response = await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${coinIds.join(',')}&order=market_cap_desc&per_page=100&page=1&sparkline=true`);
                if(!response.ok) throw new Error('API Gagal');
                const data = await response.json();
                return data;
            } catch (error) {
                console.error("Price fetch error:", error);
                return null;
            }
        }
        
        async function renderPriceTracker(container) {
            container.innerHTML = `<div id="price-tracker" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4">
                ${Array(6).fill('').map(() => `<div class="h-40 skeleton-loader"></div>`).join('')}
            </div>`;
            const data = await fetchCryptoPrices();
            const priceTrackerEl = document.getElementById('price-tracker');

            if (data && data.length > 0) {
                priceTrackerEl.innerHTML = '';
                data.forEach(coin => {
                    const change = coin.price_change_percentage_24h;
                    const changeClass = change >= 0 ? 'text-green-500' : 'text-red-500';
                    
                    priceTrackerEl.innerHTML += `
                    <div class="flip-card h-40 rounded-xl">
                        <div class="flip-card-inner">
                            <div class="flip-card-front glass-card p-4 rounded-xl">
                                <div class="flex items-center gap-2">
                                    <img src="${coin.image}" alt="${coin.name}" class="w-6 h-6">
                                    <h4 class="font-bold text-sm capitalize">${coin.name}</h4>
                                </div>
                                <div>
                                    <p class="text-xl font-semibold">$${coin.current_price.toLocaleString()}</p>
                                    <p class="text-sm font-medium ${changeClass}">${change ? change.toFixed(2) : 'N/A'}%</p>
                                </div>
                            </div>
                            <div class="flip-card-back glass-card p-2 rounded-xl">
                                <canvas id="sparkline-${coin.id}"></canvas>
                            </div>
                        </div>
                    </div>
                    `;
                });

                setTimeout(() => {
                    data.forEach(coin => {
                        const ctx = document.getElementById(`sparkline-${coin.id}`)?.getContext('2d');
                        if (ctx) {
                            new Chart(ctx, {
                                type: 'line',
                                data: {
                                    labels: coin.sparkline_in_7d.price.map((_, i) => i),
                                    datasets: [{
                                        data: coin.sparkline_in_7d.price,
                                        borderColor: coin.price_change_percentage_24h >= 0 ? '#22c55e' : '#ef4444',
                                        borderWidth: 2,
                                        fill: true,
                                        backgroundColor: coin.price_change_percentage_24h >= 0 ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)',
                                        tension: 0.4,
                                        pointRadius: 0
                                    }]
                                },
                                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
                            });
                        }
                    });
                }, 0);
            } else {
                priceTrackerEl.innerHTML = `<div class="col-span-full text-center text-red-500 p-4 glass-card rounded-xl">Gagal memuat data harga. Coba lagi nanti.</div>`;
            }
        }
        
        function renderQuiz(container) { 
            let currentQuestions = [...fullQuizBank].sort(() => 0.5 - Math.random()).slice(0, 5);
            let score = 0; 
            let questionIndex = 0; 

            function displayQuestion() { 
                if (questionIndex < currentQuestions.length) { 
                    const qData = currentQuestions[questionIndex]; 
                    container.innerHTML = ` <div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800"> <div class="mb-4"> <p class="text-sm text-slate-500 dark:text-slate-400">Pertanyaan ${questionIndex + 1} dari ${currentQuestions.length}</p> <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2.5 mt-1"> <div id="progress-bar" class="bg-gradient-to-r from-cyan-500 to-blue-500 h-2.5 rounded-full" style="width: ${((questionIndex) / currentQuestions.length) * 100}%"></div> </div> </div> <h3 class="text-2xl font-bold text-slate-900 dark:text-white mb-6">${qData.q}</h3> <div id="quiz-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"> ${qData.o.map(opt => `<button data-answer="${opt}" class="quiz-option text-left w-full p-4 bg-slate-100 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 hover:border-cyan-500 hover:ring-2 hover:ring-cyan-500">${opt}</button>`).join('')} </div> </div>`; 
                    document.getElementById('progress-bar').style.width = `${((questionIndex + 1) / currentQuestions.length) * 100}%`; 
                } else { 
                    const xpGained = score * 10;
                    let currentXP = parseInt(localStorage.getItem('cryptoHubXP') || '0');
                    currentXP += xpGained;
                    localStorage.setItem('cryptoHubXP', currentXP);
                    updateUserProfile();
                    if(score > 3) triggerConfetti();

                    container.innerHTML = `<div class="bg-white dark:bg-slate-900 p-8 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 text-center"> <h3 class="text-3xl font-bold text-slate-900 dark:text-white mb-4">Kuis Selesai!</h3> <p class="text-xl text-slate-600 dark:text-slate-300 mb-6">Skor akhir Anda:</p> <p class="text-6xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-blue-600 mb-2">${score} / ${currentQuestions.length}</p><p class="font-semibold text-green-500 mb-8">+${xpGained} XP</p> <button id="restart-quiz-btn" class="px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-lg hover:opacity-90 transition-opacity">Ulangi Kuis</button> </div>`; 
                } 
            } 
            container.addEventListener('click', e => { if (e.target && e.target.matches('.quiz-option')) { const selected = e.target.dataset.answer; const correct = currentQuestions[questionIndex].a; document.querySelectorAll('.quiz-option').forEach(btn => { btn.disabled = true; if(btn.dataset.answer === correct) btn.classList.add('bg-green-500', 'text-white', 'border-green-500'); else if (btn.dataset.answer === selected) btn.classList.add('bg-red-500', 'text-white', 'border-red-500'); }); if(selected === correct) score++; setTimeout(() => { questionIndex++; displayQuestion(); }, 1500); } else if(e.target && e.target.id === 'restart-quiz-btn') { renderQuiz(container); } }); 
            displayQuestion();
        }
        
        function renderTools(container) { container.innerHTML = ` <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"> <div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800"> <h3 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-500 to-blue-500 mb-4">Kalkulator Profit/Loss</h3> <form id="pnl-form" class="space-y-4"> <div><label class="text-sm font-medium">Harga Beli ($)</label><input type="number" id="buy-price" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border border-slate-300 dark:border-slate-700" placeholder="e.g., 50000" required></div> <div><label class="text-sm font-medium">Harga Jual ($)</label><input type="number" id="sell-price" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border border-slate-300 dark:border-slate-700" placeholder="e.g., 60000" required></div> <div><label class="text-sm font-medium">Jumlah Aset</label><input type="number" id="amount" step="any" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border border-slate-300 dark:border-slate-700" placeholder="e.g., 0.5" required></div> <button type="submit" class="w-full px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-lg hover:opacity-90">Hitung</button> </form> <div id="pnl-result" class="mt-4"></div> </div> <div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800"> <h3 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-500 to-blue-500 mb-4">Estimator Reward Staking</h3> <form id="staking-form" class="space-y-4"> <div><label class="text-sm font-medium">Jumlah Aset di-Stake</label><input type="number" id="staked-amount" step="any" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border border-slate-300 dark:border-slate-700" placeholder="e.g., 10" required></div> <div><label class="text-sm font-medium">APY (%)</label><input type="number" id="apy" step="any" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border border-slate-300 dark:border-slate-700" placeholder="e.g., 5" required></div> <button type="submit" class="w-full px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-lg hover:opacity-90">Hitung</button> </form> <div id="staking-result" class="mt-4"></div> </div> </div>`; document.getElementById('pnl-form').addEventListener('submit', e => { e.preventDefault(); const buy = parseFloat(document.getElementById('buy-price').value); const sell = parseFloat(document.getElementById('sell-price').value); const amount = parseFloat(document.getElementById('amount').value); if(isNaN(buy) || isNaN(sell) || isNaN(amount)) return; const result = (sell - buy) * amount; const resultEl = document.getElementById('pnl-result'); resultEl.innerHTML = `<div class="p-4 rounded-md ${result >= 0 ? 'bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300' : 'bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300'}"> <p class="font-bold">${result >= 0 ? 'Estimasi Profit' : 'Estimasi Loss'}: $${Math.abs(result).toFixed(2)}</p> </div>`; }); document.getElementById('staking-form').addEventListener('submit', e => { e.preventDefault(); const amount = parseFloat(document.getElementById('staked-amount').value); const apy = parseFloat(document.getElementById('apy').value); if(isNaN(amount) || isNaN(apy)) return; const daily = (amount * (apy/100)) / 365; const resultEl = document.getElementById('staking-result'); resultEl.innerHTML = `<div class="p-4 rounded-md bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 space-y-2"> <p><strong>Harian:</strong> ${daily.toFixed(6)} aset</p> <p><strong>Bulanan:</strong> ${(daily * 30).toFixed(6)} aset</p> <p><strong>Tahunan:</strong> ${(daily * 365).toFixed(6)} aset</p> </div>`; }); }
        
        async function renderNews(container) { container.innerHTML = `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"> ${Array(6).fill('').map(() => `<div class="h-48 skeleton-loader"></div>`).join('')} </div>`; try { const response = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https%3A%2F%2Fcointelegraph.com%2Frss'); if(!response.ok) throw new Error('API Gagal'); const data = await response.json(); if(data.status !== 'ok') throw new Error('API status not ok'); container.innerHTML = `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"> ${data.items.slice(0, 6).map(item => ` <a href="${item.link}" target="_blank" rel="noopener noreferrer" class="block p-4 bg-white dark:bg-slate-900 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 hover:border-cyan-500 dark:hover:border-cyan-500 transition-colors"> <img src="${item.thumbnail}" onerror="this.src='https://placehold.co/600x400/0f172a/38bdf8?text=Berita'" class="w-full h-32 object-cover rounded-md mb-2"> <h4 class="font-bold text-slate-800 dark:text-slate-200 mb-2">${item.title}</h4> <p class="text-xs text-slate-500 dark:text-slate-400">Oleh ${item.author} - ${new Date(item.pubDate).toLocaleDateString('id-ID')}</p> </a>`).join('')} </div>`; } catch (error) { container.innerHTML = `<div class="text-center text-red-500 col-span-full">Gagal memuat berita. API mungkin sedang tidak tersedia.</div>`; } }
        
        function renderPortfolio(container) {
             container.innerHTML = ` <div class="grid grid-cols-1 lg:grid-cols-3 gap-8"> <div class="lg:col-span-2"> <div id="portfolio-summary" class="mb-6"></div> <div id="portfolio-assets" class="space-y-4"></div> </div> <div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 h-fit"> <h3 class="text-xl font-bold mb-4">Tambah Aset Baru</h3> <form id="add-asset-form" class="space-y-4"> <div><label class="text-sm font-medium">Nama Aset (e.g., bitcoin)</label><input type="text" id="asset-name" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border" required></div> <div><label class="text-sm font-medium">Jumlah</label><input type="number" step="any" id="asset-amount" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border" required></div> <div><label class="text-sm font-medium">Harga Beli Rata-rata ($)</label><input type="number" step="any" id="asset-avg-price" class="mt-1 w-full p-2 bg-slate-100 dark:bg-slate-800 rounded-md border" required></div> <button type="submit" class="w-full px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-lg">Tambah</button> </form> </div> </div>`;
             updatePortfolioDisplay();
             document.getElementById('add-asset-form').addEventListener('submit', (e) => { e.preventDefault(); const name = document.getElementById('asset-name').value.toLowerCase(); const amount = parseFloat(document.getElementById('asset-amount').value); const avgPrice = parseFloat(document.getElementById('asset-avg-price').value); if (name && !isNaN(amount) && !isNaN(avgPrice)) { addAssetToPortfolio(name, amount, avgPrice); e.target.reset(); } });
        }

        let portfolio = JSON.parse(sessionStorage.getItem('cryptoPortfolio')) || [];
        function addAssetToPortfolio(id, amount, avgPrice) { const existingAsset = portfolio.find(a => a.id === id); if(existingAsset) { const totalAmount = existingAsset.amount + amount; const totalCost = (existingAsset.amount * existingAsset.avgPrice) + (amount * avgPrice); existingAsset.avgPrice = totalCost / totalAmount; existingAsset.amount = totalAmount; } else { portfolio.push({ id, amount, avgPrice }); } sessionStorage.setItem('cryptoPortfolio', JSON.stringify(portfolio)); updatePortfolioDisplay(); }
        
        async function updatePortfolioDisplay() {
             const summaryEl = document.getElementById('portfolio-summary');
             const assetsEl = document.getElementById('portfolio-assets');
             if (!summaryEl || !assetsEl) return;
             if (portfolio.length === 0) { summaryEl.innerHTML = ''; assetsEl.innerHTML = '<p class="text-center text-slate-500 py-10">Belum ada aset.</p>'; return; }
             summaryEl.innerHTML = `<div class="h-24 skeleton-loader"></div>`;
             assetsEl.innerHTML = `<div class="h-48 skeleton-loader"></div>`;
             const coinIds = portfolio.map(a => a.id);
             const pricesData = await fetchCryptoPrices(coinIds);
             if (!pricesData) { summaryEl.innerHTML = `<p class="text-red-500">Gagal memuat harga.</p>`; assetsEl.innerHTML = ''; return; }
            
             const prices = Object.fromEntries(pricesData.map(coin => [coin.id, coin]));
             let totalValue = 0; let totalCost = 0;
             assetsEl.innerHTML = '';
             portfolio.forEach(asset => {
                 const currentPrice = prices[asset.id] ? prices[asset.id].current_price : 0;
                 const value = asset.amount * currentPrice;
                 const cost = asset.amount * asset.avgPrice;
                 const pnl = value - cost;
                 const pnlPercent = (pnl / cost) * 100;
                 totalValue += value;
                 totalCost += cost;
                 assetsEl.innerHTML += `
                    <div class="bg-white dark:bg-slate-900 p-4 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 flex items-center justify-between">
                         <div><h4 class="font-bold text-lg capitalize">${asset.id}</h4><p class="text-sm text-slate-500">${asset.amount} @ $${asset.avgPrice.toLocaleString()}</p></div>
                         <div class="text-right"><p class="font-semibold text-lg">$${value.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p><p class="text-sm ${pnl >= 0 ? 'text-green-500' : 'text-red-500'}">${pnl >= 0 ? '▲' : '▼'} $${Math.abs(pnl).toFixed(2)} (${isNaN(pnlPercent) ? 0 : pnlPercent.toFixed(2)}%)</p></div>
                    </div>`;
             });

             const totalPnl = totalValue - totalCost;
             const totalPnlPercent = (totalPnl / totalCost) * 100;
             summaryEl.innerHTML = `
                <div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800">
                     <p class="text-sm text-slate-500">Total Nilai Portofolio</p>
                     <p class="text-4xl font-extrabold text-slate-800 dark:text-white mt-1 mb-2">$${totalValue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                     <p class="font-semibold ${totalPnl >= 0 ? 'text-green-500' : 'text-red-500'}">${totalPnl >= 0 ? '▲' : '▼'} $${Math.abs(totalPnl).toFixed(2)} (${isNaN(totalPnlPercent) ? 0 : totalPnlPercent.toFixed(2)}%) Total P/L</p>
                     <div class="mt-4 h-48"><canvas id="portfolio-chart"></canvas></div>
                </div>`;
            
            const chartCtx = document.getElementById('portfolio-chart')?.getContext('2d');
            if (chartCtx) {
                new Chart(chartCtx, { type: 'doughnut', data: { labels: portfolio.map(a => a.id.charAt(0).toUpperCase() + a.id.slice(1)), datasets: [{ data: portfolio.map(a => a.amount * (prices[a.id]?.current_price || 0)), backgroundColor: ['#06b6d4', '#8b5cf6', '#22c55e', '#ef4444', '#f59e0b', '#3b82f6'], borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' } } } });
            }
        }
        
        function triggerConfetti(){ let cnv = document.getElementById('confetti-canvas'); let ctx = cnv.getContext('2d'); let W = window.innerWidth; let H = window.innerHeight; cnv.width = W; cnv.height = H; let particles = []; let K = []; let C = ["#06b6d4","#8b5cf6","#22c55e","#ef4444","#f59e0b"]; for(let i=0;i<25;i++){particles.push({x:W/2,y:H/2,r:Math.random()*4+1,d:Math.random()*25,c:C[Math.floor(Math.random()*C.length)],a:Math.random()*360});} function draw(){ctx.clearRect(0,0,W,H); for(let i=0;i<25;i++){let p=particles[i]; ctx.beginPath(); ctx.moveTo(p.x,p.y); ctx.arc(p.x,p.y,p.r,0,Math.PI*2,true); ctx.fillStyle=p.c; ctx.fill(); p.x+=Math.sin(p.a*Math.PI/180); p.y+=Math.cos(p.a*Math.PI/180)+p.d*0.1; if(p.x>W+5||p.x<-5||p.y>H){particles[i]={x:Math.random()*W,y:-10,r:p.r,d:p.d,c:p.c,a:p.a}}}} let interval = setInterval(draw,15); setTimeout(() => {clearInterval(interval); cnv.getContext('2d').clearRect(0,0,W,H);}, 3000); }

        function updateUserProfile() {
            let xp = parseInt(localStorage.getItem('cryptoHubXP') || '0');
            let level = Math.floor(xp / 100) + 1;
            let xpForNextLevel = (level) * 100;
            let progress = (xp % 100) / 100 * 100;

            const profileEl = document.getElementById('user-profile');
            profileEl.innerHTML = `
            <div class="text-center">
                <p class="font-bold text-sm text-slate-700 dark:text-white">Level ${level}</p>
                <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2 my-1">
                    <div class="bg-gradient-to-r from-cyan-400 to-purple-500 h-2 rounded-full" style="width: ${progress}%"></div>
                </div>
                <p class="text-xs text-slate-500 dark:text-slate-400">${xp} / ${xpForNextLevel} XP</p>
            </div>`;
        }
        
        // --- AUTHENTICATION & INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            const passwordOverlay = document.getElementById('password-overlay');
            const passwordForm = document.getElementById('password-form');
            const passwordInput = document.getElementById('password-input');
            const passwordError = document.getElementById('password-error');
            const passwordBox = document.getElementById('password-box');
            const appContainer = document.getElementById('app-container');
            const correctPassword = 'crypto123';

            const unlockApp = () => {
                passwordOverlay.classList.add('opacity-0', 'pointer-events-none');
                appContainer.classList.remove('hidden');
                appContainer.classList.add('animate-fadeIn');
                initializeMainApp();
            };

            passwordForm.addEventListener('submit', (e) => {
                e.preventDefault();
                if (passwordInput.value === correctPassword) {
                    sessionStorage.setItem('isLoggedIn', 'true');
                    unlockApp();
                } else {
                    passwordError.textContent = 'Password salah!';
                    passwordBox.classList.add('animate-shake');
                    setTimeout(() => passwordBox.classList.remove('animate-shake'), 500);
                }
            });
            
            if (sessionStorage.getItem('isLoggedIn') === 'true') {
                unlockApp();
            }
        });

        function initializeMainApp() {
            const pageContentEl = document.getElementById('page-content');
            pageContentEl.addEventListener('click', e => { const button = e.target.closest('.accordion-button'); if (button) { const content = button.nextElementSibling; button.classList.toggle('open'); if (content.style.maxHeight) { content.style.maxHeight = null; } else { content.style.maxHeight = content.scrollHeight + "px"; } } });
            pageContentEl.addEventListener('click', e => { const printButton = e.target.closest('.print-button'); if (printButton) { const cardToPrint = printButton.closest('.card-item'); const printArea = cardToPrint.cloneNode(true); printArea.classList.add('print-area', 'print-bg-white', 'print-text-black', 'print-no-shadow'); printArea.querySelector('.print-button').remove(); const printWrapper = document.createElement('div'); printWrapper.appendChild(printArea); document.body.appendChild(printWrapper); window.print(); document.body.removeChild(printWrapper); } });
            document.getElementById('focus-mode-toggle').addEventListener('click', () => { document.body.classList.toggle('focus-mode'); });
            const themeToggleButton = document.getElementById('theme-toggle');
            const darkIcon = document.getElementById('theme-toggle-dark-icon');
            const lightIcon = document.getElementById('theme-toggle-light-icon');
            const applyTheme = (theme) => { if(theme === 'dark') { document.documentElement.classList.add('dark'); darkIcon.classList.remove('hidden'); lightIcon.classList.add('hidden'); } else { document.documentElement.classList.remove('dark'); lightIcon.classList.remove('hidden'); darkIcon.classList.add('hidden'); } };
            const savedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            applyTheme(savedTheme ? savedTheme : (systemPrefersDark ? 'dark' : 'light'));
            themeToggleButton.addEventListener('click', () => { const newTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark'; localStorage.setItem('theme', newTheme); applyTheme(newTheme); });
            const navigationEl = document.getElementById('navigation').querySelector('ul');
            navigationEl.innerHTML = appData.map(page => `<li><a href="#" data-page="${page.id}" class="nav-link flex items-center gap-3 p-3 rounded-lg font-semibold text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors duration-200">${page.icon || ''}<span>${page.title}</span></a></li>`).join('');
            navigationEl.addEventListener('click', e => { const link = e.target.closest('a'); if(link && link.dataset.page) { e.preventDefault(); renderPage(link.dataset.page); } });
            
            updateUserProfile();
            renderPage('dasbor');
        }
    </script>
</body>
</html>
